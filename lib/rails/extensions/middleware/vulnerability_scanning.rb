module Rails.application.class::Middleware
  # ignore PHP vulnerability scanning
  class VulnerabilityScanning
    def initialize(app)
      @app = app
    end

    def call(env)
      # php vulnerability scanning
      if env["ORIGINAL_FULLPATH"] =~ /\A[\/\w]+\.php/
        return([
          200,
          { "Content-Type" => "text/plain" },
          ["pong"]
        ])
      end
      @app.call(env)
    end
  end
end
